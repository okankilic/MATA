@model MATA.Presentation.Web.Models.Accounts.AccountsIndexVM

@{
    ViewBag.Title = $"{Html.Localize("Accounts")} ({Model.TotalCount})";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>
    @ViewBag.Title
</h2>

<p class="text-right">
    @Html.LocalizedActionLink("Create", "_Create", null, new { id = "mt-link-accounts-create", @class = "btn btn-default" })
</p>

<div class="panel panel-default">

    <div class="panel-body" style="overflow-x:auto;">

        @{
            WebGrid grid = new WebGrid(
                rowsPerPage: Model.PageSize,
                ajaxUpdateContainerId: "account-grid",
                ajaxUpdateCallback: "accountsController.initGridEvents"
            );

            grid.Bind(Model.Accounts, autoSortAndPage: false, rowCount: Model.TotalCount);
        }

        @grid.GetHtml(
            htmlAttributes: new { id = "account-grid" },
            tableStyle: "table table-hover",
            columns: new List<WebGridColumn>()
            {
                WebGridHelper.LocalizedTextColumn("FullName"),
                WebGridHelper.LocalizedTextColumn("Email"),
                new WebGridColumn
                {
                    Header = Html.Localize("RoleName"),
                    ColumnName = "RoleName",
                    CanSort = false,
                    Format = (item) => Html.Localize(string.Format("RoleTypes_{0}", (string)item.RoleName))
                },
                new WebGridColumn
                {
                    Header = Html.Localize("IsActive"),
                    ColumnName = "IsActive",
                    CanSort = false,
                    Format = (item) => Html.ShowCheck((bool)item.IsActive)
                },
                new WebGridColumn
                {
                    Format = (item) => Html.LocalizedActionLink("Details", "Details", new { id = item.ID })
                },
                new WebGridColumn
                {
                    Format = (item) => Html.LocalizedActionLink("Update", "_Edit", new { id = item.ID }, new { @class = "mt-link-accounts-edit", data_entity_id = item.ID })
                }
            },
            mode: WebGridPagerModes.Numeric,
            numericLinksCount: 5
        )

    </div>

</div>

@section styles {

    <style type="text/css">

        #account-grid {
        }

            /*#account-grid thead tr th:nth-child(5),
        #account-grid thead tr th:nth-child(6),*/
            #account-grid tbody tr td:nth-child(3),
            #account-grid tbody tr td:nth-child(4),
            #account-grid tbody tr td:nth-child(5),
            #account-grid tbody tr td:nth-child(6) {
                width: 0.1%;
            }

        /*#account-grid tfoot tr td {
            float:right;
        }*/

    </style>

}

@section scripts {

    <script src="~/ts/mata.accounts-controller.js"></script>
}
