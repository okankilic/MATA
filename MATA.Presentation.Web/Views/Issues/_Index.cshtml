
@model MATA.Presentation.Web.Models.Issues.IssuesIndexViewModel

@{
    WebGrid grid = new WebGrid(
        rowsPerPage: Model.PageSize,
        ajaxUpdateContainerId: "issue-grid",
        ajaxUpdateCallback: "InitGridEvents"
    );

    grid.Bind(Model.Issues, autoSortAndPage: false, rowCount: Model.TotalCount);
}

@grid.GetHtml(
    htmlAttributes: new { id = "issue-grid" },
    tableStyle: "table table-hover",
    columns: new List<WebGridColumn>()
    {
        new WebGridColumn
        {
            Header = "Şantiye Adı",
            ColumnName = "StoreName",
            CanSort = false,
            //Style = "width: 300px"
        },
        new WebGridColumn
        {
            Header = "Açıklamalar",
            ColumnName = "Remarks",
            CanSort = false
        },
        new WebGridColumn
        {
            Header = "Oluşturan",
            ColumnName = "CreatedBy",
            CanSort = false
        },
        new WebGridColumn
        {
            Header = "Oluşturulma Zamanı",
            ColumnName = "CreateTime",
            CanSort = false
        },
        new WebGridColumn
        {
            //Style = "auto-width",
            Format = (item) => Html.ActionLink("Detay", "Details", new { id = item.ID })
        },
        new WebGridColumn
        {
            //Style = "auto-width",
            Format = (item) => Html.ActionLink("Güncelle", "_Edit", new { id = item.ID }, new { @class = "mt-link-issues-edit", data_issue_id = item.ID })
        }
    },
    mode: WebGridPagerModes.Numeric,
    numericLinksCount: 5
)

@section scripts {

    @Scripts.Render("~/bundles/jqueryval")

    <script src="~/ts/mata.issues-controller.js"></script>

    <script type="text/javascript">

        $(function () {
            InitGridEvents();
        });

        function InitGridEvents() {

            $('#mt-link-issues-create').click(function (e) {
                e.preventDefault();
                MATA.Issues.openCreateModal();
                return false;
            });

            $('.mt-link-issues-edit').click(function (e) {
                e.preventDefault();
                var $this = $(this),
                    issueID = $this.data("issueId");
                MATA.Issues.openEditModal(issueID);
                return false;
            });
        }

    </script>
}

