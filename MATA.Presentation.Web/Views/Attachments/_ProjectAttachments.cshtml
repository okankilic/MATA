@model MATA.Presentation.Web.Models.Attachments.AttachmentsIndexVM

<h4>
    @Html.Localize("Attachments") (@Model.TotalCount)
    @if (User.IsInRole(RoleTypes.Admin) || User.IsInRole(RoleTypes.Staff))
    {
        <a href="@Url.Action("_Create", "Attachments", new { entityName = "Project", entityID = ViewBag.ProjectID })" id="mt-link-attachments-create" class="pull-right">
            <span class="glyphicon glyphicon-plus"></span>
        </a>
    }
</h4>
<hr />

@if (Model.TotalCount == 0)
{
    @Html.Localize("NoAttachmentsForThisProject")
}
else
{
    WebGrid grid = new WebGrid(
        rowsPerPage: Model.PageSize,
        ajaxUpdateContainerId: "attachment-grid",
        ajaxUpdateCallback: "attachmentsController.initGridEvents"
    );

    grid.Bind(Model.Attachments, autoSortAndPage: false, rowCount: Model.PageSize);

    var columnList = new List<WebGridColumn>()
    {
        WebGridHelper.LocalizedTextColumn("FileName"),
        WebGridHelper.LocalizedTextColumn("AttachmentType")
    };

    if (User.IsInRole(RoleTypes.Admin))
    {
        this.AddAuditColumns(columnList);
    }

    columnList.Add(new WebGridColumn
    {
        Format = (item) => Html.LocalizedActionLink("Download", "Download", "Attachments", new { id = item.ID }, null)
    });

    @grid.GetHtml(
        htmlAttributes: new { id = "attachment-grid" },
        tableStyle: "table table-hover",
        columns: columnList,
        mode: WebGridPagerModes.Numeric,
        numericLinksCount: 5
    )
}

<script src="~/ts/mata.attachments-controller.js"></script>